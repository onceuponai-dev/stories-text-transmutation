var K=Object.defineProperty;var Q=(i,b,o)=>b in i?K(i,b,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[b]=o;var O=(i,b,o)=>(Q(i,typeof b!="symbol"?b+"":b,o),o);(function(){"use strict";let i;const b=new Array(128).fill(void 0);b.push(void 0,null,!0,!1);function o(t){return b[t]}let w=0,m=null;function h(){return(m===null||m.byteLength===0)&&(m=new Uint8Array(i.memory.buffer)),m}const k=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},v=typeof k.encodeInto=="function"?function(t,n){return k.encodeInto(t,n)}:function(t,n){const e=k.encode(t);return n.set(e),{read:t.length,written:e.length}};function p(t,n,e){if(e===void 0){const a=k.encode(t),d=n(a.length,1)>>>0;return h().subarray(d,d+a.length).set(a),w=a.length,d}let r=t.length,_=n(r,1)>>>0;const s=h();let u=0;for(;u<r;u++){const a=t.charCodeAt(u);if(a>127)break;s[_+u]=a}if(u!==r){u!==0&&(t=t.slice(u)),_=e(_,r,r=u+t.length*3,1)>>>0;const a=h().subarray(_+u,_+r),d=v(t,a);u+=d.written}return w=u,_}function U(t){return t==null}let A=null;function g(){return(A===null||A.byteLength===0)&&(A=new Int32Array(i.memory.buffer)),A}let M=b.length;function F(t){t<132||(b[t]=M,M=t)}function y(t){const n=o(t);return F(t),n}const L=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&L.decode();function l(t,n){return t=t>>>0,L.decode(h().subarray(t,t+n))}function c(t){M===b.length&&b.push(b.length+1);const n=M;return M=b[n],b[n]=t,n}let R=null;function W(){return(R===null||R.byteLength===0)&&(R=new Float64Array(i.memory.buffer)),R}function S(t){const n=typeof t;if(n=="number"||n=="boolean"||t==null)return`${t}`;if(n=="string")return`"${t}"`;if(n=="symbol"){const _=t.description;return _==null?"Symbol":`Symbol(${_})`}if(n=="function"){const _=t.name;return typeof _=="string"&&_.length>0?`Function(${_})`:"Function"}if(Array.isArray(t)){const _=t.length;let s="[";_>0&&(s+=S(t[0]));for(let u=1;u<_;u++)s+=", "+S(t[u]);return s+="]",s}const e=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(e.length>1)r=e[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function $(t,n,e,r){const _={a:t,b:n,cnt:1,dtor:e},s=(...u)=>{_.cnt++;const a=_.a;_.a=0;try{return r(a,_.b,...u)}finally{--_.cnt===0?i.__wbindgen_export_2.get(_.dtor)(a,_.b):_.a=a}};return s.original=_,s}function q(t,n,e){i._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h919bc8ff7907a860(t,n,c(e))}function j(t,n){const e=n(t.length*1,1)>>>0;return h().set(t,e/1),w=t.length,e}function f(t,n){try{return t.apply(this,n)}catch(e){i.__wbindgen_exn_store(c(e))}}function C(t,n,e,r){i.wasm_bindgen__convert__closures__invoke2_mut__h4ec435f8440d057d(t,n,c(e),c(r))}class z{__destroy_into_raw(){const n=this.__wbg_ptr;return this.__wbg_ptr=0,n}free(){const n=this.__destroy_into_raw();i.__wbg_model_free(n)}constructor(n,e,r){try{const a=i.__wbindgen_add_to_stack_pointer(-16),d=j(n,i.__wbindgen_malloc),P=w,V=j(e,i.__wbindgen_malloc),H=w,J=j(r,i.__wbindgen_malloc),G=w;i.model_load(a,d,P,V,H,J,G);var _=g()[a/4+0],s=g()[a/4+1],u=g()[a/4+2];if(u)throw y(s);return this.__wbg_ptr=_>>>0,this}finally{i.__wbindgen_add_to_stack_pointer(16)}}forward(n){try{const s=i.__wbindgen_add_to_stack_pointer(-16);i.model_forward(s,this.__wbg_ptr,c(n));var e=g()[s/4+0],r=g()[s/4+1],_=g()[s/4+2];if(_)throw y(r);return y(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}}async function B(t,n){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,n)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const e=await t.arrayBuffer();return await WebAssembly.instantiate(e,n)}else{const e=await WebAssembly.instantiate(t,n);return e instanceof WebAssembly.Instance?{instance:e,module:t}:e}}function I(){const t={};return t.wbg={},t.wbg.__wbindgen_string_get=function(n,e){const r=o(e),_=typeof r=="string"?r:void 0;var s=U(_)?0:p(_,i.__wbindgen_malloc,i.__wbindgen_realloc),u=w;g()[n/4+1]=u,g()[n/4+0]=s},t.wbg.__wbindgen_object_drop_ref=function(n){y(n)},t.wbg.__wbindgen_boolean_get=function(n){const e=o(n);return typeof e=="boolean"?e?1:0:2},t.wbg.__wbindgen_error_new=function(n,e){const r=new Error(l(n,e));return c(r)},t.wbg.__wbindgen_is_object=function(n){const e=o(n);return typeof e=="object"&&e!==null},t.wbg.__wbindgen_is_undefined=function(n){return o(n)===void 0},t.wbg.__wbindgen_in=function(n,e){return o(n)in o(e)},t.wbg.__wbindgen_object_clone_ref=function(n){const e=o(n);return c(e)},t.wbg.__wbindgen_jsval_loose_eq=function(n,e){return o(n)==o(e)},t.wbg.__wbindgen_number_get=function(n,e){const r=o(e),_=typeof r=="number"?r:void 0;W()[n/8+1]=U(_)?0:_,g()[n/4+0]=!U(_)},t.wbg.__wbg_String_389b54bd9d25375f=function(n,e){const r=String(o(e)),_=p(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=w;g()[n/4+1]=s,g()[n/4+0]=_},t.wbg.__wbindgen_number_new=function(n){return c(n)},t.wbg.__wbindgen_string_new=function(n,e){const r=l(n,e);return c(r)},t.wbg.__wbg_getwithrefkey_4a92a5eca60879b9=function(n,e){const r=o(n)[o(e)];return c(r)},t.wbg.__wbg_set_9182712abebf82ef=function(n,e,r){o(n)[y(e)]=y(r)},t.wbg.__wbg_new_abda76e883ba8a5f=function(){const n=new Error;return c(n)},t.wbg.__wbg_stack_658279fe44541cf6=function(n,e){const r=o(e).stack,_=p(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=w;g()[n/4+1]=s,g()[n/4+0]=_},t.wbg.__wbg_error_f851667af71bcfc6=function(n,e){let r,_;try{r=n,_=e,console.error(l(n,e))}finally{i.__wbindgen_free(r,_,1)}},t.wbg.__wbindgen_cb_drop=function(n){const e=y(n).original;return e.cnt--==1?(e.a=0,!0):!1},t.wbg.__wbg_alert_19497cd64cf2e76c=function(n,e){alert(l(n,e))},t.wbg.__wbg_log_447763321c4ac622=function(n,e){console.log(l(n,e))},t.wbg.__wbg_fetch_27eb4c0a08a9ca04=function(n){const e=fetch(o(n));return c(e)},t.wbg.__wbg_queueMicrotask_118eeb525d584d9a=function(n){queueMicrotask(o(n))},t.wbg.__wbg_queueMicrotask_26a89c14c53809c0=function(n){const e=o(n).queueMicrotask;return c(e)},t.wbg.__wbindgen_is_function=function(n){return typeof o(n)=="function"},t.wbg.__wbg_fetch_06d656a1b748ac0d=function(n,e){const r=o(n).fetch(o(e));return c(r)},t.wbg.__wbg_instanceof_Response_0d25bb8436a9cefe=function(n){let e;try{e=o(n)instanceof Response}catch{e=!1}return e},t.wbg.__wbg_url_47f8307501523859=function(n,e){const r=o(e).url,_=p(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=w;g()[n/4+1]=s,g()[n/4+0]=_},t.wbg.__wbg_status_351700a30c61ba61=function(n){return o(n).status},t.wbg.__wbg_headers_e38c00d713e8888c=function(n){const e=o(n).headers;return c(e)},t.wbg.__wbg_text_10c88c5e55f873c7=function(){return f(function(n){const e=o(n).text();return c(e)},arguments)},t.wbg.__wbg_new_a979e9eedc5e81a3=function(){return f(function(){const n=new Headers;return c(n)},arguments)},t.wbg.__wbg_append_047382169b61373d=function(){return f(function(n,e,r,_,s){o(n).append(l(e,r),l(_,s))},arguments)},t.wbg.__wbg_newwithstrandinit_9fd2fc855c6327eb=function(){return f(function(n,e,r){const _=new Request(l(n,e),o(r));return c(_)},arguments)},t.wbg.__wbg_signal_7876560d9d0f914c=function(n){const e=o(n).signal;return c(e)},t.wbg.__wbg_new_fa36281638875de8=function(){return f(function(){const n=new AbortController;return c(n)},arguments)},t.wbg.__wbg_abort_7792bf3f664d7bb3=function(n){o(n).abort()},t.wbg.__wbg_crypto_d05b68a3572bb8ca=function(n){const e=o(n).crypto;return c(e)},t.wbg.__wbg_process_b02b3570280d0366=function(n){const e=o(n).process;return c(e)},t.wbg.__wbg_versions_c1cb42213cedf0f5=function(n){const e=o(n).versions;return c(e)},t.wbg.__wbg_node_43b1089f407e4ec2=function(n){const e=o(n).node;return c(e)},t.wbg.__wbindgen_is_string=function(n){return typeof o(n)=="string"},t.wbg.__wbg_msCrypto_10fc94afee92bd76=function(n){const e=o(n).msCrypto;return c(e)},t.wbg.__wbg_require_9a7e0f667ead4995=function(){return f(function(){const n=module.require;return c(n)},arguments)},t.wbg.__wbg_randomFillSync_b70ccbdf4926a99d=function(){return f(function(n,e){o(n).randomFillSync(y(e))},arguments)},t.wbg.__wbg_getRandomValues_7e42b4fb8779dc6d=function(){return f(function(n,e){o(n).getRandomValues(o(e))},arguments)},t.wbg.__wbg_get_c43534c00f382c8a=function(n,e){const r=o(n)[e>>>0];return c(r)},t.wbg.__wbg_length_d99b680fd68bf71b=function(n){return o(n).length},t.wbg.__wbg_new_34c624469fb1d4fd=function(){const n=new Array;return c(n)},t.wbg.__wbg_newnoargs_5859b6d41c6fe9f7=function(n,e){const r=new Function(l(n,e));return c(r)},t.wbg.__wbg_next_1938cf110c9491d4=function(n){const e=o(n).next;return c(e)},t.wbg.__wbg_next_267398d0e0761bf9=function(){return f(function(n){const e=o(n).next();return c(e)},arguments)},t.wbg.__wbg_done_506b44765ba84b9c=function(n){return o(n).done},t.wbg.__wbg_value_31485d8770eb06ab=function(n){const e=o(n).value;return c(e)},t.wbg.__wbg_iterator_364187e1ee96b750=function(){return c(Symbol.iterator)},t.wbg.__wbg_get_5027b32da70f39b1=function(){return f(function(n,e){const r=Reflect.get(o(n),o(e));return c(r)},arguments)},t.wbg.__wbg_call_a79f1973a4f07d5e=function(){return f(function(n,e){const r=o(n).call(o(e));return c(r)},arguments)},t.wbg.__wbg_new_87d841e70661f6e9=function(){const n=new Object;return c(n)},t.wbg.__wbg_self_086b5302bcafb962=function(){return f(function(){const n=self.self;return c(n)},arguments)},t.wbg.__wbg_window_132fa5d7546f1de5=function(){return f(function(){const n=window.window;return c(n)},arguments)},t.wbg.__wbg_globalThis_e5f801a37ad7d07b=function(){return f(function(){const n=globalThis.globalThis;return c(n)},arguments)},t.wbg.__wbg_global_f9a61fce4af6b7c1=function(){return f(function(){const n=global.global;return c(n)},arguments)},t.wbg.__wbg_set_379b27f1d5f1bf9c=function(n,e,r){o(n)[e>>>0]=y(r)},t.wbg.__wbg_isArray_fbd24d447869b527=function(n){return Array.isArray(o(n))},t.wbg.__wbg_instanceof_ArrayBuffer_f4521cec1b99ee35=function(n){let e;try{e=o(n)instanceof ArrayBuffer}catch{e=!1}return e},t.wbg.__wbg_call_f6a2bc58c19c53c6=function(){return f(function(n,e,r){const _=o(n).call(o(e),o(r));return c(_)},arguments)},t.wbg.__wbg_new_1d93771b84541aa5=function(n,e){try{var r={a:n,b:e},_=(u,a)=>{const d=r.a;r.a=0;try{return C(d,r.b,u,a)}finally{r.a=d}};const s=new Promise(_);return c(s)}finally{r.a=r.b=0}},t.wbg.__wbg_resolve_97ecd55ee839391b=function(n){const e=Promise.resolve(o(n));return c(e)},t.wbg.__wbg_then_7aeb7c5f1536640f=function(n,e){const r=o(n).then(o(e));return c(r)},t.wbg.__wbg_then_5842e4e97f7beace=function(n,e,r){const _=o(n).then(o(e),o(r));return c(_)},t.wbg.__wbg_buffer_5d1b598a01b41a42=function(n){const e=o(n).buffer;return c(e)},t.wbg.__wbg_newwithbyteoffsetandlength_d695c7957788f922=function(n,e,r){const _=new Uint8Array(o(n),e>>>0,r>>>0);return c(_)},t.wbg.__wbg_new_ace717933ad7117f=function(n){const e=new Uint8Array(o(n));return c(e)},t.wbg.__wbg_set_74906aa30864df5a=function(n,e,r){o(n).set(o(e),r>>>0)},t.wbg.__wbg_length_f0764416ba5bb237=function(n){return o(n).length},t.wbg.__wbg_instanceof_Uint8Array_4f5cffed7df34b2f=function(n){let e;try{e=o(n)instanceof Uint8Array}catch{e=!1}return e},t.wbg.__wbg_newwithlength_728575f3bba9959b=function(n){const e=new Uint8Array(n>>>0);return c(e)},t.wbg.__wbg_subarray_7f7a652672800851=function(n,e,r){const _=o(n).subarray(e>>>0,r>>>0);return c(_)},t.wbg.__wbg_stringify_daa6661e90c04140=function(){return f(function(n){const e=JSON.stringify(o(n));return c(e)},arguments)},t.wbg.__wbg_has_a2919659b7b645b3=function(){return f(function(n,e){return Reflect.has(o(n),o(e))},arguments)},t.wbg.__wbg_set_37a50e901587b477=function(){return f(function(n,e,r){return Reflect.set(o(n),o(e),o(r))},arguments)},t.wbg.__wbindgen_debug_string=function(n,e){const r=S(o(e)),_=p(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=w;g()[n/4+1]=s,g()[n/4+0]=_},t.wbg.__wbindgen_throw=function(n,e){throw new Error(l(n,e))},t.wbg.__wbindgen_memory=function(){const n=i.memory;return c(n)},t.wbg.__wbindgen_closure_wrapper1050=function(n,e,r){const _=$(n,e,338,q);return c(_)},t}function N(t,n){return i=t.exports,E.__wbindgen_wasm_module=n,R=null,A=null,m=null,i.__wbindgen_start(),i}async function E(t){if(i!==void 0)return i;typeof t>"u"&&(t=new URL("/stories-text-transmutation/assets/m_bg-69e710ee.wasm",self.location));const n=I();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:e,module:r}=await B(await t,n);return N(e,r)}function D(t){let n=`https://huggingface.co/${t}/resolve/main`,e=`${n}/model.safetensors`,r=`${n}/tokenizer.json`,_=`${n}/config.json`;return{modelID:t,weightsURL:e,tokenizerURL:r,configURL:_}}async function x(t){const n="model-candle-cache",e=await caches.open(n),r=await e.match(t);if(r){const s=await r.arrayBuffer();return new Uint8Array(s)}const _=await fetch(t,{cache:"force-cache"});return e.put(t,_.clone()),new Uint8Array(await _.arrayBuffer())}class T{static async getInstance(n){if(this.instance[n])console.log("Model Already Loaded");else{await E();let e=D(n);console.log("Loading Model");const[r,_,s]=await Promise.all([x(e.weightsURL),x(e.tokenizerURL),x(e.configURL)]);this.instance[n]=new z(r,_,s),console.log("Model loaded")}return this.instance[n]}}O(T,"instance",{}),self.addEventListener("message",async t=>{const{id:n,modelID:e,sentences:r,normalize:_=!0}=t.data;try{console.log("Starting Model");const s=await T.getInstance(e);console.log("Calculating Embeddings");const u=s.forward({sentences:r,normalize_embeddings:_});self.postMessage({results:u.data,id:n})}catch(s){self.postMessage({error:s.message,id:n})}})})();
