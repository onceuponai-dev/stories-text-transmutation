var K=Object.defineProperty;var Q=(i,b,o)=>b in i?K(i,b,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[b]=o;var v=(i,b,o)=>(Q(i,typeof b!="symbol"?b+"":b,o),o);(function(){"use strict";let i;const b=new Array(128).fill(void 0);b.push(void 0,null,!0,!1);function o(e){return b[e]}let w=0,m=null;function h(){return(m===null||m.byteLength===0)&&(m=new Uint8Array(i.memory.buffer)),m}const R=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},O=typeof R.encodeInto=="function"?function(e,n){return R.encodeInto(e,n)}:function(e,n){const t=R.encode(e);return n.set(t),{read:e.length,written:t.length}};function p(e,n,t){if(t===void 0){const u=R.encode(e),d=n(u.length,1)>>>0;return h().subarray(d,d+u.length).set(u),w=u.length,d}let r=e.length,c=n(r,1)>>>0;const s=h();let a=0;for(;a<r;a++){const u=e.charCodeAt(a);if(u>127)break;s[c+a]=u}if(a!==r){a!==0&&(e=e.slice(a)),c=t(c,r,r=a+e.length*3,1)>>>0;const u=h().subarray(c+a,c+r),d=O(e,u);a+=d.written}return w=a,c}function U(e){return e==null}let A=null;function g(){return(A===null||A.byteLength===0)&&(A=new Int32Array(i.memory.buffer)),A}let M=b.length;function F(e){e<132||(b[e]=M,M=e)}function y(e){const n=o(e);return F(e),n}const L=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&L.decode();function l(e,n){return e=e>>>0,L.decode(h().subarray(e,e+n))}function _(e){M===b.length&&b.push(b.length+1);const n=M;return M=b[n],b[n]=e,n}let k=null;function W(){return(k===null||k.byteLength===0)&&(k=new Float64Array(i.memory.buffer)),k}function S(e){const n=typeof e;if(n=="number"||n=="boolean"||e==null)return`${e}`;if(n=="string")return`"${e}"`;if(n=="symbol"){const c=e.description;return c==null?"Symbol":`Symbol(${c})`}if(n=="function"){const c=e.name;return typeof c=="string"&&c.length>0?`Function(${c})`:"Function"}if(Array.isArray(e)){const c=e.length;let s="[";c>0&&(s+=S(e[0]));for(let a=1;a<c;a++)s+=", "+S(e[a]);return s+="]",s}const t=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(t.length>1)r=t[1];else return toString.call(e);if(r=="Object")try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:r}function $(e,n,t,r){const c={a:e,b:n,cnt:1,dtor:t},s=(...a)=>{c.cnt++;const u=c.a;c.a=0;try{return r(u,c.b,...a)}finally{--c.cnt===0?i.__wbindgen_export_2.get(c.dtor)(u,c.b):c.a=u}};return s.original=c,s}function q(e,n,t){i.wasm_bindgen__convert__closures__invoke1_mut__hbb6a92f07c74d8f3(e,n,_(t))}function j(e,n){const t=n(e.length*1,1)>>>0;return h().set(e,t/1),w=e.length,t}function f(e,n){try{return e.apply(this,n)}catch(t){i.__wbindgen_exn_store(_(t))}}function C(e,n,t,r){i.wasm_bindgen__convert__closures__invoke2_mut__h750c36762897e2d7(e,n,_(t),_(r))}class z{__destroy_into_raw(){const n=this.__wbg_ptr;return this.__wbg_ptr=0,n}free(){const n=this.__destroy_into_raw();i.__wbg_model_free(n)}constructor(n,t,r){try{const u=i.__wbindgen_add_to_stack_pointer(-16),d=j(n,i.__wbindgen_malloc),P=w,V=j(t,i.__wbindgen_malloc),H=w,J=j(r,i.__wbindgen_malloc),G=w;i.model_load(u,d,P,V,H,J,G);var c=g()[u/4+0],s=g()[u/4+1],a=g()[u/4+2];if(a)throw y(s);return this.__wbg_ptr=c>>>0,this}finally{i.__wbindgen_add_to_stack_pointer(16)}}forward(n){try{const s=i.__wbindgen_add_to_stack_pointer(-16);i.model_forward(s,this.__wbg_ptr,_(n));var t=g()[s/4+0],r=g()[s/4+1],c=g()[s/4+2];if(c)throw y(r);return y(t)}finally{i.__wbindgen_add_to_stack_pointer(16)}}}async function B(e,n){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,n)}catch(r){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await e.arrayBuffer();return await WebAssembly.instantiate(t,n)}else{const t=await WebAssembly.instantiate(e,n);return t instanceof WebAssembly.Instance?{instance:t,module:e}:t}}function I(){const e={};return e.wbg={},e.wbg.__wbindgen_string_get=function(n,t){const r=o(t),c=typeof r=="string"?r:void 0;var s=U(c)?0:p(c,i.__wbindgen_malloc,i.__wbindgen_realloc),a=w;g()[n/4+1]=a,g()[n/4+0]=s},e.wbg.__wbindgen_object_drop_ref=function(n){y(n)},e.wbg.__wbindgen_error_new=function(n,t){const r=new Error(l(n,t));return _(r)},e.wbg.__wbindgen_boolean_get=function(n){const t=o(n);return typeof t=="boolean"?t?1:0:2},e.wbg.__wbindgen_is_object=function(n){const t=o(n);return typeof t=="object"&&t!==null},e.wbg.__wbindgen_is_undefined=function(n){return o(n)===void 0},e.wbg.__wbindgen_in=function(n,t){return o(n)in o(t)},e.wbg.__wbindgen_object_clone_ref=function(n){const t=o(n);return _(t)},e.wbg.__wbindgen_jsval_loose_eq=function(n,t){return o(n)==o(t)},e.wbg.__wbindgen_number_get=function(n,t){const r=o(t),c=typeof r=="number"?r:void 0;W()[n/8+1]=U(c)?0:c,g()[n/4+0]=!U(c)},e.wbg.__wbg_String_389b54bd9d25375f=function(n,t){const r=String(o(t)),c=p(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=w;g()[n/4+1]=s,g()[n/4+0]=c},e.wbg.__wbindgen_number_new=function(n){return _(n)},e.wbg.__wbindgen_string_new=function(n,t){const r=l(n,t);return _(r)},e.wbg.__wbg_getwithrefkey_4a92a5eca60879b9=function(n,t){const r=o(n)[o(t)];return _(r)},e.wbg.__wbg_set_9182712abebf82ef=function(n,t,r){o(n)[y(t)]=y(r)},e.wbg.__wbg_new_abda76e883ba8a5f=function(){const n=new Error;return _(n)},e.wbg.__wbg_stack_658279fe44541cf6=function(n,t){const r=o(t).stack,c=p(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=w;g()[n/4+1]=s,g()[n/4+0]=c},e.wbg.__wbg_error_f851667af71bcfc6=function(n,t){let r,c;try{r=n,c=t,console.error(l(n,t))}finally{i.__wbindgen_free(r,c,1)}},e.wbg.__wbindgen_cb_drop=function(n){const t=y(n).original;return t.cnt--==1?(t.a=0,!0):!1},e.wbg.__wbg_alert_19497cd64cf2e76c=function(n,t){alert(l(n,t))},e.wbg.__wbg_log_447763321c4ac622=function(n,t){console.log(l(n,t))},e.wbg.__wbg_fetch_6a2624d7f767e331=function(n){const t=fetch(o(n));return _(t)},e.wbg.__wbg_queueMicrotask_4d890031a6a5a50c=function(n){queueMicrotask(o(n))},e.wbg.__wbg_queueMicrotask_adae4bc085237231=function(n){const t=o(n).queueMicrotask;return _(t)},e.wbg.__wbindgen_is_function=function(n){return typeof o(n)=="function"},e.wbg.__wbg_fetch_693453ca3f88c055=function(n,t){const r=o(n).fetch(o(t));return _(r)},e.wbg.__wbg_new_7a20246daa6eec7e=function(){return f(function(){const n=new Headers;return _(n)},arguments)},e.wbg.__wbg_append_aa3f462f9e2b5ff2=function(){return f(function(n,t,r,c,s){o(n).append(l(t,r),l(c,s))},arguments)},e.wbg.__wbg_instanceof_Response_4c3b1446206114d1=function(n){let t;try{t=o(n)instanceof Response}catch{t=!1}return t},e.wbg.__wbg_url_83a6a4f65f7a2b38=function(n,t){const r=o(t).url,c=p(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=w;g()[n/4+1]=s,g()[n/4+0]=c},e.wbg.__wbg_status_d6d47ad2837621eb=function(n){return o(n).status},e.wbg.__wbg_headers_24def508a7518df9=function(n){const t=o(n).headers;return _(t)},e.wbg.__wbg_text_668782292b0bc561=function(){return f(function(n){const t=o(n).text();return _(t)},arguments)},e.wbg.__wbg_signal_3c701f5f40a5f08d=function(n){const t=o(n).signal;return _(t)},e.wbg.__wbg_new_0ae46f44b7485bb2=function(){return f(function(){const n=new AbortController;return _(n)},arguments)},e.wbg.__wbg_abort_2c4fb490d878d2b2=function(n){o(n).abort()},e.wbg.__wbg_newwithstrandinit_f581dff0d19a8b03=function(){return f(function(n,t,r){const c=new Request(l(n,t),o(r));return _(c)},arguments)},e.wbg.__wbg_crypto_58f13aa23ffcb166=function(n){const t=o(n).crypto;return _(t)},e.wbg.__wbg_process_5b786e71d465a513=function(n){const t=o(n).process;return _(t)},e.wbg.__wbg_versions_c2ab80650590b6a2=function(n){const t=o(n).versions;return _(t)},e.wbg.__wbg_node_523d7bd03ef69fba=function(n){const t=o(n).node;return _(t)},e.wbg.__wbindgen_is_string=function(n){return typeof o(n)=="string"},e.wbg.__wbg_msCrypto_abcb1295e768d1f2=function(n){const t=o(n).msCrypto;return _(t)},e.wbg.__wbg_require_2784e593a4674877=function(){return f(function(){const n=module.require;return _(n)},arguments)},e.wbg.__wbg_randomFillSync_a0d98aa11c81fe89=function(){return f(function(n,t){o(n).randomFillSync(y(t))},arguments)},e.wbg.__wbg_getRandomValues_504510b5564925af=function(){return f(function(n,t){o(n).getRandomValues(o(t))},arguments)},e.wbg.__wbg_get_f01601b5a68d10e3=function(n,t){const r=o(n)[t>>>0];return _(r)},e.wbg.__wbg_length_1009b1af0c481d7b=function(n){return o(n).length},e.wbg.__wbg_new_ffc6d4d085022169=function(){const n=new Array;return _(n)},e.wbg.__wbg_newnoargs_c62ea9419c21fbac=function(n,t){const r=new Function(l(n,t));return _(r)},e.wbg.__wbg_next_9b877f231f476d01=function(n){const t=o(n).next;return _(t)},e.wbg.__wbg_next_6529ee0cca8d57ed=function(){return f(function(n){const t=o(n).next();return _(t)},arguments)},e.wbg.__wbg_done_5fe336b092d60cf2=function(n){return o(n).done},e.wbg.__wbg_value_0c248a78fdc8e19f=function(n){const t=o(n).value;return _(t)},e.wbg.__wbg_iterator_db7ca081358d4fb2=function(){return _(Symbol.iterator)},e.wbg.__wbg_get_7b48513de5dc5ea4=function(){return f(function(n,t){const r=Reflect.get(o(n),o(t));return _(r)},arguments)},e.wbg.__wbg_call_90c26b09837aba1c=function(){return f(function(n,t){const r=o(n).call(o(t));return _(r)},arguments)},e.wbg.__wbg_new_9fb8d994e1c0aaac=function(){const n=new Object;return _(n)},e.wbg.__wbg_self_f0e34d89f33b99fd=function(){return f(function(){const n=self.self;return _(n)},arguments)},e.wbg.__wbg_window_d3b084224f4774d7=function(){return f(function(){const n=window.window;return _(n)},arguments)},e.wbg.__wbg_globalThis_9caa27ff917c6860=function(){return f(function(){const n=globalThis.globalThis;return _(n)},arguments)},e.wbg.__wbg_global_35dfdd59a4da3e74=function(){return f(function(){const n=global.global;return _(n)},arguments)},e.wbg.__wbg_set_f2740edb12e318cd=function(n,t,r){o(n)[t>>>0]=y(r)},e.wbg.__wbg_isArray_74fb723e24f76012=function(n){return Array.isArray(o(n))},e.wbg.__wbg_instanceof_ArrayBuffer_e7d53d51371448e2=function(n){let t;try{t=o(n)instanceof ArrayBuffer}catch{t=!1}return t},e.wbg.__wbg_call_5da1969d7cd31ccd=function(){return f(function(n,t,r){const c=o(n).call(o(t),o(r));return _(c)},arguments)},e.wbg.__wbg_new_60f57089c7563e81=function(n,t){try{var r={a:n,b:t},c=(a,u)=>{const d=r.a;r.a=0;try{return C(d,r.b,a,u)}finally{r.a=d}};const s=new Promise(c);return _(s)}finally{r.a=r.b=0}},e.wbg.__wbg_resolve_6e1c6553a82f85b7=function(n){const t=Promise.resolve(o(n));return _(t)},e.wbg.__wbg_then_3ab08cd4fbb91ae9=function(n,t){const r=o(n).then(o(t));return _(r)},e.wbg.__wbg_then_8371cc12cfedc5a2=function(n,t,r){const c=o(n).then(o(t),o(r));return _(c)},e.wbg.__wbg_buffer_a448f833075b71ba=function(n){const t=o(n).buffer;return _(t)},e.wbg.__wbg_newwithbyteoffsetandlength_d0482f893617af71=function(n,t,r){const c=new Uint8Array(o(n),t>>>0,r>>>0);return _(c)},e.wbg.__wbg_new_8f67e318f15d7254=function(n){const t=new Uint8Array(o(n));return _(t)},e.wbg.__wbg_set_2357bf09366ee480=function(n,t,r){o(n).set(o(t),r>>>0)},e.wbg.__wbg_length_1d25fa9e4ac21ce7=function(n){return o(n).length},e.wbg.__wbg_instanceof_Uint8Array_bced6f43aed8c1aa=function(n){let t;try{t=o(n)instanceof Uint8Array}catch{t=!1}return t},e.wbg.__wbg_newwithlength_6c2df9e2f3028c43=function(n){const t=new Uint8Array(n>>>0);return _(t)},e.wbg.__wbg_subarray_2e940e41c0f5a1d9=function(n,t,r){const c=o(n).subarray(t>>>0,r>>>0);return _(c)},e.wbg.__wbg_has_9c711aafa4b444a2=function(){return f(function(n,t){return Reflect.has(o(n),o(t))},arguments)},e.wbg.__wbg_set_759f75cd92b612d2=function(){return f(function(n,t,r){return Reflect.set(o(n),o(t),o(r))},arguments)},e.wbg.__wbg_stringify_e1b19966d964d242=function(){return f(function(n){const t=JSON.stringify(o(n));return _(t)},arguments)},e.wbg.__wbindgen_debug_string=function(n,t){const r=S(o(t)),c=p(r,i.__wbindgen_malloc,i.__wbindgen_realloc),s=w;g()[n/4+1]=s,g()[n/4+0]=c},e.wbg.__wbindgen_throw=function(n,t){throw new Error(l(n,t))},e.wbg.__wbindgen_memory=function(){const n=i.memory;return _(n)},e.wbg.__wbindgen_closure_wrapper1047=function(n,t,r){const c=$(n,t,309,q);return _(c)},e}function N(e,n){return i=e.exports,E.__wbindgen_wasm_module=n,k=null,A=null,m=null,i.__wbindgen_start(),i}async function E(e){if(i!==void 0)return i;typeof e>"u"&&(e=new URL("/stories-text-transmutation/assets/m_bg-8b982bdd.wasm",self.location));const n=I();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:t,module:r}=await B(await e,n);return N(t,r)}function D(e){let n=`https://huggingface.co/${e}/resolve/main`,t=`${n}/model.safetensors`,r=`${n}/tokenizer.json`,c=`${n}/config.json`;return{modelID:e,weightsURL:t,tokenizerURL:r,configURL:c}}async function x(e){const n="model-candle-cache",t=await caches.open(n),r=await t.match(e);if(r){const s=await r.arrayBuffer();return new Uint8Array(s)}const c=await fetch(e,{cache:"force-cache"});return t.put(e,c.clone()),new Uint8Array(await c.arrayBuffer())}class T{static async getInstance(n){if(this.instance[n])console.log("Model Already Loaded");else{await E();let t=D(n);console.log("Loading Model");const[r,c,s]=await Promise.all([x(t.weightsURL),x(t.tokenizerURL),x(t.configURL)]);this.instance[n]=new z(r,c,s),console.log("Model loaded")}return this.instance[n]}}v(T,"instance",{}),self.addEventListener("message",async e=>{const{id:n,modelID:t,sentences:r,normalize:c=!0}=e.data;try{console.log("Starting Model");const s=await T.getInstance(t);console.log("Calculating Embeddings");const a=s.forward({sentences:r,normalize_embeddings:c});self.postMessage({results:a.data,id:n})}catch(s){self.postMessage({error:s.message,id:n})}})})();
